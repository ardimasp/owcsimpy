<!DOCTYPE html>
<!-- Generated by Cython 0.29.7 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: cutils.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.7</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="cutils.c">cutils.c</a></p>
<div class="cython"><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="c"># distutils: language = c</span></pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_kp_u_checkBlockage_line_22, __pyx_kp_u_To_check_whether_two_planes_are) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: <span class="c"># cython: cdivision = True</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: <span class="c"># cython: boundscheck = False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: <span class="c"># cython: wraparound = False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: <span class="c"># cython: profile = False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: <span class="k">import</span> <span class="nn">cython</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">008</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 8, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 8, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">009</span>: <span class="k">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sp, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">010</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">malloc</span><span class="p">,</span> <span class="n">free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">M_PI</span><span class="p">,</span><span class="n">cos</span><span class="p">,</span><span class="n">sin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">sqrt</span><span class="p">,</span><span class="nb">pow</span><span class="p">,</span><span class="n">fabs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: <span class="k">from</span> <span class="nn">cpython.mem</span> <span class="k">cimport</span> <span class="n">PyMem_Malloc</span><span class="p">,</span> <span class="n">PyMem_Realloc</span><span class="p">,</span> <span class="n">PyMem_Free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: <span class="k">from</span> <span class="nn">.</span> <span class="k">cimport</span> <span class="n">cutils</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">int_t</span> <span class="n">DTYPE_int_t</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_int_t __pyx_t_8owcsimpy_8geoutils_6cutils_DTYPE_int_t;
</pre><pre class="cython line score-0">&#xA0;<span class="">019</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">float64_t</span> <span class="n">DTYPE_float64_t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: </pre>
<pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">022</span>: <span class="k">def</span> <span class="nf">checkBlockage</span><span class="p">(</span><span class="n">plane1</span><span class="p">,</span><span class="n">plane2</span><span class="p">,</span><span class="n">planeB</span><span class="p">,</span><span class="n">nargout</span><span class="o">=</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-77 '>/* Python wrapper */
static PyObject *__pyx_pw_8owcsimpy_8geoutils_6cutils_1checkBlockage(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8owcsimpy_8geoutils_6cutils_checkBlockage[] = "checkBlockage(plane1, plane2, planeB, nargout=1)\n To check whether two planes are blocked by another plane.\n\n    Parameters\n    ----------\n    plane1,plane2,planeB: SimplePlane\n        plane1 and plane2 are the tested planes that will be checked whether they \n        are blocked by planeB. SimplePlane refers to a tuple of normalVect, \n        ctrPoint, verts and area of a rectangular plane \n        (see :class:`~owcsimpy.geoobjects.bases.rectplane_py.RectPlane_py`).\n    nargout: int (optional)\n        If nargout\n\n    Returns\n    -------\n    isBlocked: bool\n        `True` denotes the blockage event occurs; otherwise, it returns `False`.\n    intersectingPoint: ndarray(3,)\n        The intersecting point on the planeB. \n\n    Notes\n    -----\n    The blocakge event is defined when the intersecting point of the line \n    segment from/to plane1 to/from plane2 intersects planeB and the intersecting \n    point is inside the convex hull of the planeB, and it lies between \n    the line segment of plane1 and plane2.\n\n    Instead of using a convex hull, comparing the area of 4 triangles and the square\n    is faster. The triangles are formed from the intersecting point and two vertices \n    of the plane.\n\n    Examples\n    --------\n\n    .. plot::\n        :format: doctest\n        :include-source: True\n\n        &gt;&gt;&gt; import numpy as np\n        &gt;&gt;&gt; import matplotlib.pyplot as plt\n        &gt;&gt;&gt; \n        &gt;&gt;&gt; from owcsimpy.geoobjects.bases.rectplane_py import RectPlane_py as RectPlane\n        &gt;&gt;&gt; from owcsimpy.geoutils.draw import draw\n        &gt;&gt;&gt; from owcsimpy.geoobjects.bases.vector_py import Vector_py as Vector\n        &gt;&gt;&gt; from owcsimpy.geoutils.cutils import checkBlockage\n        &gt;&gt;&gt; \n        &gt;&gt;&gt; # Planes\n        &gt;&gt;&gt; planes = []\n        &gt;&gt;&gt; \n        &gt;&gt;&gt; normalVect = Vector(np.array([1,np.deg2rad(90),np.deg2rad(0)]),which='spherical')\n        &gt;&gt;&gt; ctrPoint = np.array([0,2,1])\n        &gt;&gt;&gt; planes.append(RectPlane(normalVect,ctrPoint=ctrPoint"",\n        &gt;&gt;&gt;     RodriguesAngle=np.deg2rad(0),dimensions=[1.7,1]))\n        &gt;&gt;&gt; \n        &gt;&gt;&gt; normalVect = Vector(np.array([1,np.deg2rad(90),np.deg2rad(180)]),which='spherical')\n        &gt;&gt;&gt; ctrPoint = np.array([4,2,2])\n        &gt;&gt;&gt; planes.append(RectPlane(normalVect,ctrPoint=ctrPoint,\n        &gt;&gt;&gt;     RodriguesAngle=np.deg2rad(0),dimensions=[1.7,1]))\n        &gt;&gt;&gt; \n        &gt;&gt;&gt; # This should not block\n        &gt;&gt;&gt; normalVect = Vector(np.array([1,np.deg2rad(115),np.deg2rad(222)]),which='spherical')\n        &gt;&gt;&gt; ctrPoint = np.array([2,4,1])\n        &gt;&gt;&gt; planes.append(RectPlane(normalVect,ctrPoint=ctrPoint,RodriguesAngle=np.deg2rad(0),dimensions=[1.7,1]))\n        &gt;&gt;&gt; \n        &gt;&gt;&gt; # This should block\n        &gt;&gt;&gt; normalVect = Vector(np.array([1,np.deg2rad(115),np.deg2rad(222)]),which='spherical')\n        &gt;&gt;&gt; ctrPoint = np.array([2,2,1])\n        &gt;&gt;&gt; planes.append(RectPlane(normalVect,ctrPoint=ctrPoint,RodriguesAngle=np.deg2rad(0),dimensions=[1.7,1]))\n        &gt;&gt;&gt; \n        &gt;&gt;&gt; # This should not block\n        &gt;&gt;&gt; normalVect = Vector(np.array([1,np.deg2rad(90),np.deg2rad(180)]),which='spherical')\n        &gt;&gt;&gt; ctrPoint = np.array([5,2,3])\n        &gt;&gt;&gt; planes.append(RectPlane(normalVect,ctrPoint=ctrPoint,RodriguesAngle=np.deg2rad(0),dimensions=[1.7,1]))\n        &gt;&gt;&gt; \n        &gt;&gt;&gt; # Prepare canvases\n        &gt;&gt;&gt; fig,axs = draw(subplots=True,figsize=(14,6),nrows=1,ncols=3,xlim=[0,5],ylim=[0,5],zlim=[0,3],\n        &gt;&gt;&gt;     azim=-32,elev=25)\n        &gt;&gt;&gt; \n        &gt;&gt;&gt; for idx in range(2,5):\n        &gt;&gt;&gt;     colors = ['red','red','black']\n        &gt;&gt;&gt;     fig,axs[idx-2] = draw(figure=fig,axes=axs[idx-2],planes=[planes[0],planes[1],planes[idx]],\n        &gt;&gt;&gt;         colors=colors,facecolors=colors)\n        &gt;&gt;&gt; \n        &gt;&gt;&gt;     ray = np.append(planes[0].ctrPoint,planes[1].ctrPoint).reshape(2,-1)\n        &gt;&gt;&gt; \n        &gt;&gt;&gt;     # Draw ray\n        &gt;&gt;&gt;     axs[idx-2].plot(ray[:,0],ray[:,1],ray[:,2],color='k');\n        &gt;&gt;&gt; \n        &gt;&gt;&gt;     # Get simple planes from each plane""\n        &gt;&gt;&gt;     plane1 = planes[0].getSimplePlane()\n        &gt;&gt;&gt;     plane2 = planes[1].getSimplePlane()\n        &gt;&gt;&gt;     planeB = planes[idx].getSimplePlane()\n        &gt;&gt;&gt; \n        &gt;&gt;&gt;     # Check whether the blockage occurs\n        &gt;&gt;&gt;     isBlocked,intersectingPoint = checkBlockage(plane1,plane2,planeB,nargout=2)\n        &gt;&gt;&gt; \n        &gt;&gt;&gt;     if intersectingPoint is not None:\n        &gt;&gt;&gt;         xi,yi,zi = intersectingPoint\n        &gt;&gt;&gt;         axs[idx-2].scatter(xi,yi,zi)\n        &gt;&gt;&gt;         \n        &gt;&gt;&gt;     axs[idx-2].set_title(\"isBlocked: {}\".format(isBlocked))\n        &gt;&gt;&gt; \n        &gt;&gt;&gt; plt.show()\n\n\n    ";
static PyMethodDef __pyx_mdef_8owcsimpy_8geoutils_6cutils_1checkBlockage = {"checkBlockage", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8owcsimpy_8geoutils_6cutils_1checkBlockage, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8owcsimpy_8geoutils_6cutils_checkBlockage};
static PyObject *__pyx_pw_8owcsimpy_8geoutils_6cutils_1checkBlockage(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_plane1 = 0;
  PyObject *__pyx_v_plane2 = 0;
  PyObject *__pyx_v_planeB = 0;
  PyObject *__pyx_v_nargout = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("checkBlockage (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_plane1,&amp;__pyx_n_s_plane2,&amp;__pyx_n_s_planeB,&amp;__pyx_n_s_nargout,0};
    PyObject* values[4] = {0,0,0,0};
    values[3] = ((PyObject *)((PyObject *)__pyx_int_1));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_plane1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_plane2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("checkBlockage", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_planeB)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("checkBlockage", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nargout);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "checkBlockage") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_plane1 = values[0];
    __pyx_v_plane2 = values[1];
    __pyx_v_planeB = values[2];
    __pyx_v_nargout = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("checkBlockage", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("owcsimpy.geoutils.cutils.checkBlockage", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8owcsimpy_8geoutils_6cutils_checkBlockage(__pyx_self, __pyx_v_plane1, __pyx_v_plane2, __pyx_v_planeB, __pyx_v_nargout);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8owcsimpy_8geoutils_6cutils_checkBlockage(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_plane1, PyObject *__pyx_v_plane2, PyObject *__pyx_v_planeB, PyObject *__pyx_v_nargout) {
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_v_ctrPoint1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_junk = NULL;
  PyObject *__pyx_v_ctrPoint2 = NULL;
  PyObject *__pyx_v_normalVectB = NULL;
  PyObject *__pyx_v_ctrPointB = NULL;
  PyObject *__pyx_v_vertsB = NULL;
  PyObject *__pyx_v_areaB = NULL;
  Point __pyx_v_ctrPoint1_c;
  Point __pyx_v_ctrPoint2_c;
  Point __pyx_v_normalVectB_c;
  Point __pyx_v_ctrPointB_c;
  Point __pyx_v_vertsB_c[4];
  double __pyx_v_areaB_c;
  long __pyx_v_idx;
  double __pyx_v_isBlocked;
  PyObject *__pyx_v_u = NULL;
  PyObject *__pyx_v_w = NULL;
  PyObject *__pyx_v_intersectingPoint = NULL;
  PyObject *__pyx_v_ti = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("checkBlockage", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("owcsimpy.geoutils.cutils.checkBlockage", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ctrPoint1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_junk);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ctrPoint2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_normalVectB);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ctrPointB);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertsB);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_areaB);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_w);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_intersectingPoint);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ti);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(24, __pyx_n_s_plane1, __pyx_n_s_plane2, __pyx_n_s_planeB, __pyx_n_s_nargout, __pyx_n_s__9, __pyx_n_s_ctrPoint1, __pyx_n_s_junk, __pyx_n_s_ctrPoint2, __pyx_n_s_normalVectB, __pyx_n_s_ctrPointB, __pyx_n_s_vertsB, __pyx_n_s_areaB, __pyx_n_s_ctrPoint1_c, __pyx_n_s_ctrPoint2_c, __pyx_n_s_normalVectB_c, __pyx_n_s_ctrPointB_c, __pyx_n_s_vertsB_c, __pyx_n_s_areaB_c, __pyx_n_s_idx, __pyx_n_s_isBlocked, __pyx_n_s_u, __pyx_n_s_w, __pyx_n_s_intersectingPoint, __pyx_n_s_ti);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
  __pyx_codeobj__11 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 24, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__10, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_owcsimpy_geoutils_cutils_pyx, __pyx_n_s_checkBlockage, 22, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_8owcsimpy_8geoutils_6cutils_1checkBlockage, 0, __pyx_n_s_checkBlockage, NULL, __pyx_n_s_owcsimpy_geoutils_cutils, __pyx_d, ((PyObject *)__pyx_codeobj__11));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_1, __pyx_tuple__12);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_checkBlockage, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_int_1));<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class="cython line score-0">&#xA0;<span class="">023</span>:     <span class="sd">&quot;&quot;&quot; To check whether two planes are blocked by another plane.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: <span class="sd">    plane1,plane2,planeB: SimplePlane</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: <span class="sd">        plane1 and plane2 are the tested planes that will be checked whether they </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>: <span class="sd">        are blocked by planeB. SimplePlane refers to a tuple of normalVect, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>: <span class="sd">        ctrPoint, verts and area of a rectangular plane </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: <span class="sd">        (see :class:`~owcsimpy.geoobjects.bases.rectplane_py.RectPlane_py`).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>: <span class="sd">    nargout: int (optional)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>: <span class="sd">        If nargout</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>: <span class="sd">    isBlocked: bool</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>: <span class="sd">        `True` denotes the blockage event occurs; otherwise, it returns `False`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>: <span class="sd">    intersectingPoint: ndarray(3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: <span class="sd">        The intersecting point on the planeB. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>: <span class="sd">    The blocakge event is defined when the intersecting point of the line </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>: <span class="sd">    segment from/to plane1 to/from plane2 intersects planeB and the intersecting </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>: <span class="sd">    point is inside the convex hull of the planeB, and it lies between </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>: <span class="sd">    the line segment of plane1 and plane2.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">048</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>: <span class="sd">    Instead of using a convex hull, comparing the area of 4 triangles and the square</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>: <span class="sd">    is faster. The triangles are formed from the intersecting point and two vertices </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>: <span class="sd">    of the plane.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>: <span class="sd">    Examples</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>: <span class="sd">    --------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>: <span class="sd">    .. plot::</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>: <span class="sd">        :format: doctest</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>: <span class="sd">        :include-source: True</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>: <span class="sd">        &gt;&gt;&gt; import numpy as np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>: <span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>: <span class="sd">        &gt;&gt;&gt; from owcsimpy.geoobjects.bases.rectplane_py import RectPlane_py as RectPlane</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>: <span class="sd">        &gt;&gt;&gt; from owcsimpy.geoutils.draw import draw</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>: <span class="sd">        &gt;&gt;&gt; from owcsimpy.geoobjects.bases.vector_py import Vector_py as Vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: <span class="sd">        &gt;&gt;&gt; from owcsimpy.geoutils.cutils import checkBlockage</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>: <span class="sd">        &gt;&gt;&gt; # Planes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>: <span class="sd">        &gt;&gt;&gt; planes = []</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>: <span class="sd">        &gt;&gt;&gt; normalVect = Vector(np.array([1,np.deg2rad(90),np.deg2rad(0)]),which=&#39;spherical&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>: <span class="sd">        &gt;&gt;&gt; ctrPoint = np.array([0,2,1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: <span class="sd">        &gt;&gt;&gt; planes.append(RectPlane(normalVect,ctrPoint=ctrPoint,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>: <span class="sd">        &gt;&gt;&gt;     RodriguesAngle=np.deg2rad(0),dimensions=[1.7,1]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>: <span class="sd">        &gt;&gt;&gt; normalVect = Vector(np.array([1,np.deg2rad(90),np.deg2rad(180)]),which=&#39;spherical&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>: <span class="sd">        &gt;&gt;&gt; ctrPoint = np.array([4,2,2])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>: <span class="sd">        &gt;&gt;&gt; planes.append(RectPlane(normalVect,ctrPoint=ctrPoint,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: <span class="sd">        &gt;&gt;&gt;     RodriguesAngle=np.deg2rad(0),dimensions=[1.7,1]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>: <span class="sd">        &gt;&gt;&gt; # This should not block</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>: <span class="sd">        &gt;&gt;&gt; normalVect = Vector(np.array([1,np.deg2rad(115),np.deg2rad(222)]),which=&#39;spherical&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>: <span class="sd">        &gt;&gt;&gt; ctrPoint = np.array([2,4,1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>: <span class="sd">        &gt;&gt;&gt; planes.append(RectPlane(normalVect,ctrPoint=ctrPoint,RodriguesAngle=np.deg2rad(0),dimensions=[1.7,1]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>: <span class="sd">        &gt;&gt;&gt; # This should block</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">087</span>: <span class="sd">        &gt;&gt;&gt; normalVect = Vector(np.array([1,np.deg2rad(115),np.deg2rad(222)]),which=&#39;spherical&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>: <span class="sd">        &gt;&gt;&gt; ctrPoint = np.array([2,2,1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>: <span class="sd">        &gt;&gt;&gt; planes.append(RectPlane(normalVect,ctrPoint=ctrPoint,RodriguesAngle=np.deg2rad(0),dimensions=[1.7,1]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>: <span class="sd">        &gt;&gt;&gt; # This should not block</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>: <span class="sd">        &gt;&gt;&gt; normalVect = Vector(np.array([1,np.deg2rad(90),np.deg2rad(180)]),which=&#39;spherical&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>: <span class="sd">        &gt;&gt;&gt; ctrPoint = np.array([5,2,3])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>: <span class="sd">        &gt;&gt;&gt; planes.append(RectPlane(normalVect,ctrPoint=ctrPoint,RodriguesAngle=np.deg2rad(0),dimensions=[1.7,1]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>: <span class="sd">        &gt;&gt;&gt; # Prepare canvases</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>: <span class="sd">        &gt;&gt;&gt; fig,axs = draw(subplots=True,figsize=(14,6),nrows=1,ncols=3,xlim=[0,5],ylim=[0,5],zlim=[0,3],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>: <span class="sd">        &gt;&gt;&gt;     azim=-32,elev=25)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>: <span class="sd">        &gt;&gt;&gt; for idx in range(2,5):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>: <span class="sd">        &gt;&gt;&gt;     colors = [&#39;red&#39;,&#39;red&#39;,&#39;black&#39;]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>: <span class="sd">        &gt;&gt;&gt;     fig,axs[idx-2] = draw(figure=fig,axes=axs[idx-2],planes=[planes[0],planes[1],planes[idx]],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>: <span class="sd">        &gt;&gt;&gt;         colors=colors,facecolors=colors)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>: <span class="sd">        &gt;&gt;&gt;     ray = np.append(planes[0].ctrPoint,planes[1].ctrPoint).reshape(2,-1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>: <span class="sd">        &gt;&gt;&gt;     # Draw ray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>: <span class="sd">        &gt;&gt;&gt;     axs[idx-2].plot(ray[:,0],ray[:,1],ray[:,2],color=&#39;k&#39;);</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>: <span class="sd">        &gt;&gt;&gt;     # Get simple planes from each plane</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>: <span class="sd">        &gt;&gt;&gt;     plane1 = planes[0].getSimplePlane()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>: <span class="sd">        &gt;&gt;&gt;     plane2 = planes[1].getSimplePlane()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>: <span class="sd">        &gt;&gt;&gt;     planeB = planes[idx].getSimplePlane()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">114</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">115</span>: <span class="sd">        &gt;&gt;&gt;     # Check whether the blockage occurs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">116</span>: <span class="sd">        &gt;&gt;&gt;     isBlocked,intersectingPoint = checkBlockage(plane1,plane2,planeB,nargout=2)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">118</span>: <span class="sd">        &gt;&gt;&gt;     if intersectingPoint is not None:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">119</span>: <span class="sd">        &gt;&gt;&gt;         xi,yi,zi = intersectingPoint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">120</span>: <span class="sd">        &gt;&gt;&gt;         axs[idx-2].scatter(xi,yi,zi)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>: <span class="sd">        &gt;&gt;&gt;         </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">122</span>: <span class="sd">        &gt;&gt;&gt;     axs[idx-2].set_title(&quot;isBlocked: {}&quot;.format(isBlocked))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">123</span>: <span class="sd">        &gt;&gt;&gt; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>: <span class="sd">        &gt;&gt;&gt; plt.show()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">127</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">128</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">129</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">130</span>:     <span class="c"># Unpack the tuples</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">131</span>:     <span class="c"># _,ctrPoint1,_,_ = plane1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">132</span>:     <span class="c"># _,ctrPoint2,_,_ = plane2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">133</span>:     <span class="c"># normalVectB,ctrPointB,vertsB,areaB = planeB</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:     <span class="n">_</span><span class="p">,</span><span class="n">ctrPoint1</span><span class="p">,</span><span class="o">*</span><span class="n">junk</span> <span class="o">=</span> <span class="n">plane1</span></pre>
<pre class='cython code score-16 '>  {
    Py_ssize_t index = -1;
    PyObject** temps[3] = {&amp;__pyx_t_1,&amp;__pyx_t_2};
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_plane1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;
    for (index=0; index &lt; 2; index++) {
      PyObject* item = __pyx_t_4(__pyx_t_3); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(item);
      *(temps[index]) = item;
    }
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  __pyx_t_5 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v__ = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_ctrPoint1 = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_junk = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:     <span class="n">_</span><span class="p">,</span><span class="n">ctrPoint2</span><span class="p">,</span><span class="o">*</span><span class="n">junk</span> <span class="o">=</span> <span class="n">plane2</span></pre>
<pre class='cython code score-18 '>  {
    Py_ssize_t index = -1;
    PyObject** temps[3] = {&amp;__pyx_t_5,&amp;__pyx_t_2};
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_plane2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;
    for (index=0; index &lt; 2; index++) {
      PyObject* item = __pyx_t_4(__pyx_t_1); if (unlikely(!item)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(item);
      *(temps[index]) = item;
    }
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_4 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
    __pyx_L6_unpacking_done:;
  }
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_v_ctrPoint2 = __pyx_t_2;
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_junk, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>:     <span class="n">normalVectB</span><span class="p">,</span><span class="n">ctrPointB</span><span class="p">,</span><span class="n">vertsB</span><span class="p">,</span><span class="n">areaB</span><span class="p">,</span><span class="o">*</span><span class="n">junk</span> <span class="o">=</span> <span class="n">planeB</span></pre>
<pre class='cython code score-17 '>  {
    Py_ssize_t index = -1;
    PyObject** temps[5] = {&amp;__pyx_t_3,&amp;__pyx_t_2,&amp;__pyx_t_5,&amp;__pyx_t_1};
    __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_planeB);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = Py_TYPE(__pyx_t_6)-&gt;tp_iternext;
    for (index=0; index &lt; 4; index++) {
      PyObject* item = __pyx_t_4(__pyx_t_6); if (unlikely(!item)) goto __pyx_L7_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(item);
      *(temps[index]) = item;
    }
    goto __pyx_L8_unpacking_done;
    __pyx_L7_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_4 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 136, __pyx_L1_error)</span>
    __pyx_L8_unpacking_done:;
  }
  __pyx_t_7 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_normalVectB = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_ctrPointB = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_vertsB = __pyx_t_5;
  __pyx_t_5 = 0;
  __pyx_v_areaB = __pyx_t_1;
  __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_junk, ((PyObject*)__pyx_t_7));
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">137</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">138</span>:     <span class="k">cdef</span> <span class="kt">Point</span> <span class="nf">ctrPoint1_c</span><span class="p">,</span> <span class="nf">ctrPoint2_c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>:     <span class="k">cdef</span> <span class="kt">Point</span> <span class="nf">normalVectB_c</span><span class="p">,</span> <span class="nf">ctrPointB_c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>:     <span class="k">cdef</span> <span class="kt">Point</span> <span class="kt">vertsB_c</span>[4]</pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">areaB_c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>: </pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:     <span class="n">ctrPoint1_c</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span><span class="n">ctrPoint1</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="s">&#39;y&#39;</span><span class="p">:</span><span class="n">ctrPoint1</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="s">&#39;z&#39;</span><span class="p">:</span><span class="n">ctrPoint1</span><span class="p">[</span><span class="mf">2</span><span class="p">]}</span></pre>
<pre class='cython code score-39 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ctrPoint1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.x = __pyx_t_9;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ctrPoint1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.y = __pyx_t_9;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ctrPoint1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.z = __pyx_t_9;
  __pyx_v_ctrPoint1_c = __pyx_t_8;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:     <span class="n">ctrPoint2_c</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span><span class="n">ctrPoint2</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="s">&#39;y&#39;</span><span class="p">:</span><span class="n">ctrPoint2</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="s">&#39;z&#39;</span><span class="p">:</span><span class="n">ctrPoint2</span><span class="p">[</span><span class="mf">2</span><span class="p">]}</span></pre>
<pre class='cython code score-39 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ctrPoint2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.x = __pyx_t_9;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ctrPoint2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.y = __pyx_t_9;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ctrPoint2, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.z = __pyx_t_9;
  __pyx_v_ctrPoint2_c = __pyx_t_8;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:     <span class="n">ctrPointB_c</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span><span class="n">ctrPointB</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="s">&#39;y&#39;</span><span class="p">:</span><span class="n">ctrPointB</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="s">&#39;z&#39;</span><span class="p">:</span><span class="n">ctrPointB</span><span class="p">[</span><span class="mf">2</span><span class="p">]}</span></pre>
<pre class='cython code score-39 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ctrPointB, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.x = __pyx_t_9;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ctrPointB, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.y = __pyx_t_9;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ctrPointB, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.z = __pyx_t_9;
  __pyx_v_ctrPointB_c = __pyx_t_8;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:     <span class="n">normalVectB_c</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span><span class="n">normalVectB</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="s">&#39;y&#39;</span><span class="p">:</span><span class="n">normalVectB</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="s">&#39;z&#39;</span><span class="p">:</span><span class="n">normalVectB</span><span class="p">[</span><span class="mf">2</span><span class="p">]}</span></pre>
<pre class='cython code score-39 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_normalVectB, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.x = __pyx_t_9;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_normalVectB, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.y = __pyx_t_9;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_normalVectB, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.z = __pyx_t_9;
  __pyx_v_normalVectB_c = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">147</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">148</span>:     <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_10 = 0; __pyx_t_10 &lt; 4; __pyx_t_10+=1) {
    __pyx_v_idx = __pyx_t_10;
</pre><pre class="cython line score-72" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:         <span class="n">vertsB_c</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span><span class="n">vertsB</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="s">&#39;y&#39;</span><span class="p">:</span><span class="n">vertsB</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="s">&#39;z&#39;</span><span class="p">:</span><span class="n">vertsB</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]}</span></pre>
<pre class='cython code score-72 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_idx);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_0);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertsB, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8.x = __pyx_t_9;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_idx);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertsB, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8.y = __pyx_t_9;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_idx);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_2);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertsB, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8.z = __pyx_t_9;
    (__pyx_v_vertsB_c[__pyx_v_idx]) = __pyx_t_8;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">150</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:     <span class="n">areaB_c</span> <span class="o">=</span> <span class="n">areaB</span></pre>
<pre class='cython code score-10 '>  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_areaB); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
  __pyx_v_areaB_c = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">152</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:     <span class="n">isBlocked</span> <span class="o">=</span> <span class="n">checkBlockage_c</span><span class="p">(</span><span class="n">ctrPoint1_c</span><span class="p">,</span> <span class="n">ctrPoint2_c</span><span class="p">,</span> <span class="n">ctrPointB_c</span><span class="p">,</span> <span class="n">normalVectB_c</span><span class="p">,</span> <span class="n">vertsB_c</span><span class="p">,</span> <span class="n">areaB_c</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_isBlocked = checkBlockage_c(__pyx_v_ctrPoint1_c, __pyx_v_ctrPoint2_c, __pyx_v_ctrPointB_c, __pyx_v_normalVectB_c, __pyx_v_vertsB_c, __pyx_v_areaB_c);
</pre><pre class="cython line score-0">&#xA0;<span class="">154</span>:     <span class="c"># totalarea = checkBlockage_c(ctrPoint1_c, ctrPoint2_c, ctrPointB_c, normalVectB_c, vertsB_c, areaB_c)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">155</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">156</span>:     <span class="c"># if np.allclose(areaB,totalarea):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">157</span>:     <span class="c">#     isBlocked = True</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">158</span>:     <span class="c"># else:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>:     <span class="c">#     isBlocked = False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">161</span>:     <span class="k">if</span> <span class="n">nargout</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_nargout, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:         <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">isBlocked</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_isBlocked);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 162, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!(!__pyx_t_11)));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:     <span class="k">elif</span> <span class="n">nargout</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_nargout, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">164</span>:     <span class="c"># elif nargout == 2 or nargout == 3:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">165</span>:         <span class="c"># FIXME: Calculation of intersectingPoint is pure python</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">166</span>:         <span class="c"># Unpack the tuples</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">167</span>:         <span class="c"># _,ctrPoint1,_,_ = plane1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>:         <span class="c"># _,ctrPoint2,_,_ = plane2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>:         <span class="c"># normalVectB,ctrPointB,vertsB,areaB = planeB</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:         <span class="n">_</span><span class="p">,</span><span class="n">ctrPoint1</span><span class="p">,</span><span class="o">*</span><span class="n">junk</span> <span class="o">=</span> <span class="n">plane1</span></pre>
<pre class='cython code score-19 '>    {
      Py_ssize_t index = -1;
      PyObject** temps[3] = {&amp;__pyx_t_7,&amp;__pyx_t_1};
      __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_plane1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
      for (index=0; index &lt; 2; index++) {
        PyObject* item = __pyx_t_4(__pyx_t_5); if (unlikely(!item)) goto __pyx_L12_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      goto __pyx_L13_unpacking_done;
      __pyx_L12_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_4 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 170, __pyx_L1_error)</span>
      __pyx_L13_unpacking_done:;
    }
    __pyx_t_2 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_7);
    __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ctrPoint1, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_junk, ((PyObject*)__pyx_t_2));
    __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">171</span>:         <span class="n">_</span><span class="p">,</span><span class="n">ctrPoint2</span><span class="p">,</span><span class="o">*</span><span class="n">junk</span> <span class="o">=</span> <span class="n">plane2</span></pre>
<pre class='cython code score-19 '>    {
      Py_ssize_t index = -1;
      PyObject** temps[3] = {&amp;__pyx_t_2,&amp;__pyx_t_1};
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_plane2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 171, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_4 = Py_TYPE(__pyx_t_7)-&gt;tp_iternext;
      for (index=0; index &lt; 2; index++) {
        PyObject* item = __pyx_t_4(__pyx_t_7); if (unlikely(!item)) goto __pyx_L14_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      goto __pyx_L15_unpacking_done;
      __pyx_L14_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_4 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 171, __pyx_L1_error)</span>
      __pyx_L15_unpacking_done:;
    }
    __pyx_t_5 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 171, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ctrPoint2, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_junk, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>:         <span class="n">normalVectB</span><span class="p">,</span><span class="n">ctrPointB</span><span class="p">,</span><span class="n">vertsB</span><span class="p">,</span><span class="n">areaB</span><span class="p">,</span><span class="o">*</span><span class="n">junk</span> <span class="o">=</span> <span class="n">planeB</span></pre>
<pre class='cython code score-21 '>    {
      Py_ssize_t index = -1;
      PyObject** temps[5] = {&amp;__pyx_t_5,&amp;__pyx_t_1,&amp;__pyx_t_2,&amp;__pyx_t_7};
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_planeB);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 172, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;
      for (index=0; index &lt; 4; index++) {
        PyObject* item = __pyx_t_4(__pyx_t_3); if (unlikely(!item)) goto __pyx_L16_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      goto __pyx_L17_unpacking_done;
      __pyx_L16_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_4 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 172, __pyx_L1_error)</span>
      __pyx_L17_unpacking_done:;
    }
    __pyx_t_6 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 172, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_normalVectB, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ctrPointB, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertsB, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_areaB, __pyx_t_7);
    __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_junk, ((PyObject*)__pyx_t_6));
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">173</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>:         <span class="c"># Check intersection</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">175</span>:         <span class="c"># see http://geomalgorithms.com/a05-_intersect-1.html</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">176</span>:         <span class="n">u</span> <span class="o">=</span> <span class="n">ctrPoint2</span><span class="o">-</span><span class="n">ctrPoint1</span></pre>
<pre class='cython code score-5 '>    __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_ctrPoint2, __pyx_v_ctrPoint1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 176, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_v_u = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:         <span class="n">w</span> <span class="o">=</span> <span class="n">ctrPoint1</span><span class="o">-</span><span class="n">ctrPointB</span></pre>
<pre class='cython code score-5 '>    __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_ctrPoint1, __pyx_v_ctrPointB);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_v_w = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">178</span>: </pre>
<pre class="cython line score-88" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">179</span>:         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">normalVectB</span><span class="p">,</span><span class="n">u</span><span class="p">),</span><span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-88 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_allclose);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_12 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_12 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_normalVectB, __pyx_v_u};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_normalVectB, __pyx_v_u};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (__pyx_t_1) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_normalVectB);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_normalVectB);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_12, __pyx_v_normalVectB);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_u);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_u);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_12, __pyx_v_u);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_12 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_12 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_7, __pyx_int_0};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_7, __pyx_int_0};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (__pyx_t_5) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_12, __pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_12, __pyx_int_0);
      __pyx_t_7 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_11) {
/* … */
      goto __pyx_L18;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">180</span>:             <span class="c"># Line segment and the planeB is parallel</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>:             <span class="n">intersectingPoint</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-1 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      __pyx_v_intersectingPoint = Py_None;
</pre><pre class="cython line score-0">&#xA0;<span class="">182</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>:             <span class="c"># Parametric value of the intersecting point</span></pre>
<pre class="cython line score-94" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">185</span>:             <span class="n">ti</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">normalVectB</span><span class="p">,</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">normalVectB</span><span class="p">,</span><span class="n">u</span><span class="p">)</span></pre>
<pre class='cython code score-94 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = NULL;
      __pyx_t_12 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_12 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
        PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_normalVectB, __pyx_v_w};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
        PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_normalVectB, __pyx_v_w};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      } else
      #endif
      {
        __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        if (__pyx_t_2) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_normalVectB);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_normalVectB);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_12, __pyx_v_normalVectB);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_w);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_w);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_12, __pyx_v_w);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = NULL;
      __pyx_t_12 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_12 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_normalVectB, __pyx_v_u};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_normalVectB, __pyx_v_u};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      } else
      #endif
      {
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        if (__pyx_t_7) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_7); __pyx_t_7 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_normalVectB);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_normalVectB);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_12, __pyx_v_normalVectB);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_u);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_u);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_12, __pyx_v_u);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_v_ti = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>:             <span class="c"># The intersecting point</span></pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">188</span>:             <span class="n">intersectingPoint</span> <span class="o">=</span> <span class="n">ctrPoint1</span><span class="o">+</span><span class="n">ti</span><span class="o">*</span><span class="n">u</span></pre>
<pre class='cython code score-11 '>      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_ti, __pyx_v_u);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 188, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_ctrPoint1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 188, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_intersectingPoint = __pyx_t_6;
      __pyx_t_6 = 0;
    }
    __pyx_L18:;
</pre><pre class="cython line score-0">&#xA0;<span class="">189</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>:         <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">isBlocked</span><span class="p">),</span><span class="n">intersectingPoint</span></pre>
<pre class='cython code score-19 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_isBlocked);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 190, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!(!__pyx_t_11)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 190, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 190, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_intersectingPoint);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_intersectingPoint);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_intersectingPoint);
    __pyx_t_6 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">191</span>:         <span class="c"># if nargout == 2:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>:         <span class="c">#     return bool(isBlocked),intersectingPoint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>:         <span class="c"># elif nargout == 3:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>:         <span class="c">#     return bool(isBlocked),intersectingPoint,totalarea</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>: </pre>
<pre class="cython line score-103" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>: <span class="k">def</span> <span class="nf">calcArea3DPoly</span><span class="p">(</span><span class="nb">int</span> <span class="n">n</span><span class="p">,</span></pre>
<pre class='cython code score-103 '>/* Python wrapper */
static PyObject *__pyx_pw_8owcsimpy_8geoutils_6cutils_3calcArea3DPoly(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8owcsimpy_8geoutils_6cutils_2calcArea3DPoly[] = "calcArea3DPoly(int n, ndarray Vx, ndarray Vy, ndarray Vz, ndarray Nnp)";
static PyMethodDef __pyx_mdef_8owcsimpy_8geoutils_6cutils_3calcArea3DPoly = {"calcArea3DPoly", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8owcsimpy_8geoutils_6cutils_3calcArea3DPoly, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8owcsimpy_8geoutils_6cutils_2calcArea3DPoly};
static PyObject *__pyx_pw_8owcsimpy_8geoutils_6cutils_3calcArea3DPoly(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_n;
  PyArrayObject *__pyx_v_Vx = 0;
  PyArrayObject *__pyx_v_Vy = 0;
  PyArrayObject *__pyx_v_Vz = 0;
  PyArrayObject *__pyx_v_Nnp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calcArea3DPoly (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_Vx,&amp;__pyx_n_s_Vy,&amp;__pyx_n_s_Vz,&amp;__pyx_n_s_Nnp,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Vx)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcArea3DPoly", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Vy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcArea3DPoly", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Vz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcArea3DPoly", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Nnp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcArea3DPoly", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcArea3DPoly") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_n = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_n == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L3_error)</span>
    __pyx_v_Vx = ((PyArrayObject *)values[1]);
    __pyx_v_Vy = ((PyArrayObject *)values[2]);
    __pyx_v_Vz = ((PyArrayObject *)values[3]);
    __pyx_v_Nnp = ((PyArrayObject *)values[4]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcArea3DPoly", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("owcsimpy.geoutils.cutils.calcArea3DPoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Vx), __pyx_ptype_5numpy_ndarray, 1, "Vx", 0))) <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Vy), __pyx_ptype_5numpy_ndarray, 1, "Vy", 0))) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Vz), __pyx_ptype_5numpy_ndarray, 1, "Vz", 0))) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Nnp), __pyx_ptype_5numpy_ndarray, 1, "Nnp", 0))) <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8owcsimpy_8geoutils_6cutils_2calcArea3DPoly(__pyx_self, __pyx_v_n, __pyx_v_Vx, __pyx_v_Vy, __pyx_v_Vz, __pyx_v_Nnp);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8owcsimpy_8geoutils_6cutils_2calcArea3DPoly(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_n, PyArrayObject *__pyx_v_Vx, PyArrayObject *__pyx_v_Vy, PyArrayObject *__pyx_v_Vz, PyArrayObject *__pyx_v_Nnp) {
  Point *__pyx_v_ps;
  Point __pyx_v_N;
  long __pyx_v_idx;
  double __pyx_v_area;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Nnp;
  __Pyx_Buffer __pyx_pybuffer_Nnp;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Vx;
  __Pyx_Buffer __pyx_pybuffer_Vx;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Vy;
  __Pyx_Buffer __pyx_pybuffer_Vy;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Vz;
  __Pyx_Buffer __pyx_pybuffer_Vz;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calcArea3DPoly", 0);
  __pyx_pybuffer_Vx.pybuffer.buf = NULL;
  __pyx_pybuffer_Vx.refcount = 0;
  __pyx_pybuffernd_Vx.data = NULL;
  __pyx_pybuffernd_Vx.rcbuffer = &amp;__pyx_pybuffer_Vx;
  __pyx_pybuffer_Vy.pybuffer.buf = NULL;
  __pyx_pybuffer_Vy.refcount = 0;
  __pyx_pybuffernd_Vy.data = NULL;
  __pyx_pybuffernd_Vy.rcbuffer = &amp;__pyx_pybuffer_Vy;
  __pyx_pybuffer_Vz.pybuffer.buf = NULL;
  __pyx_pybuffer_Vz.refcount = 0;
  __pyx_pybuffernd_Vz.data = NULL;
  __pyx_pybuffernd_Vz.rcbuffer = &amp;__pyx_pybuffer_Vz;
  __pyx_pybuffer_Nnp.pybuffer.buf = NULL;
  __pyx_pybuffer_Nnp.refcount = 0;
  __pyx_pybuffernd_Nnp.data = NULL;
  __pyx_pybuffernd_Nnp.rcbuffer = &amp;__pyx_pybuffer_Nnp;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Vx.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Vx, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_Vx.diminfo[0].strides = __pyx_pybuffernd_Vx.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Vx.diminfo[0].shape = __pyx_pybuffernd_Vx.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Vy.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Vy, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_Vy.diminfo[0].strides = __pyx_pybuffernd_Vy.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Vy.diminfo[0].shape = __pyx_pybuffernd_Vy.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Vz.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Vz, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_Vz.diminfo[0].strides = __pyx_pybuffernd_Vz.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Vz.diminfo[0].shape = __pyx_pybuffernd_Vz.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Nnp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Nnp, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_Nnp.diminfo[0].strides = __pyx_pybuffernd_Nnp.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Nnp.diminfo[0].shape = __pyx_pybuffernd_Nnp.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Nnp.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Vx.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Vy.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Vz.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("owcsimpy.geoutils.cutils.calcArea3DPoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Nnp.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Vx.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Vy.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Vz.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_n, __pyx_n_s_Vx, __pyx_n_s_Vy, __pyx_n_s_Vz, __pyx_n_s_Nnp, __pyx_n_s_ps, __pyx_n_s_N, __pyx_n_s_idx, __pyx_n_s_area);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 196, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_8owcsimpy_8geoutils_6cutils_3calcArea3DPoly, 0, __pyx_n_s_calcArea3DPoly, NULL, __pyx_n_s_owcsimpy_geoutils_cutils, __pyx_d, ((PyObject *)__pyx_codeobj__14));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 196, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calcArea3DPoly, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__14 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__13, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_owcsimpy_geoutils_cutils_pyx, __pyx_n_s_calcArea3DPoly, 196, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 196, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">197</span>:     <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">dtype</span><span class="o">=</span><span class="n">double</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">Vx</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">198</span>:     <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">dtype</span><span class="o">=</span><span class="n">double</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">Vy</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">199</span>:     <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">dtype</span><span class="o">=</span><span class="n">double</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">Vz</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">200</span>:     <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">dtype</span><span class="o">=</span><span class="n">double</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">Nnp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">201</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">202</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:     <span class="k">cdef</span> <span class="kt">Point</span> *<span class="nf">ps</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Point</span> <span class="o">*&gt;</span> <span class="n">malloc</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Point</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ps = ((Point *)malloc(((__pyx_v_n + 1) * (sizeof(Point)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>:     <span class="k">cdef</span> <span class="kt">Point</span> <span class="nf">N</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span><span class="n">Nnp</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="s">&#39;y&#39;</span><span class="p">:</span><span class="n">Nnp</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="s">&#39;z&#39;</span><span class="p">:</span><span class="n">Nnp</span><span class="p">[</span><span class="mf">2</span><span class="p">]}</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  __pyx_t_1.x = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Nnp.rcbuffer-&gt;pybuffer.buf, __pyx_t_2, __pyx_pybuffernd_Nnp.diminfo[0].strides));
  __pyx_t_3 = 1;
  __pyx_t_1.y = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Nnp.rcbuffer-&gt;pybuffer.buf, __pyx_t_3, __pyx_pybuffernd_Nnp.diminfo[0].strides));
  __pyx_t_4 = 2;
  __pyx_t_1.z = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Nnp.rcbuffer-&gt;pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_Nnp.diminfo[0].strides));
  __pyx_v_N = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">205</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>:     <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_n + 1);
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_idx = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:         <span class="n">ps</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span><span class="n">Vx</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span><span class="s">&#39;y&#39;</span><span class="p">:</span><span class="n">Vy</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span><span class="s">&#39;z&#39;</span><span class="p">:</span><span class="n">Vz</span><span class="p">[</span><span class="n">idx</span><span class="p">]}</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_idx;
    __pyx_t_1.x = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Vx.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_Vx.diminfo[0].strides));
    __pyx_t_9 = __pyx_v_idx;
    __pyx_t_1.y = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Vy.rcbuffer-&gt;pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_Vy.diminfo[0].strides));
    __pyx_t_10 = __pyx_v_idx;
    __pyx_t_1.z = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Vz.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Vz.diminfo[0].strides));
    (__pyx_v_ps[__pyx_v_idx]) = __pyx_t_1;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">208</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:     <span class="n">area</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">calcArea3DPoly_c</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">ps</span><span class="p">,</span><span class="n">N</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_area = fabs(calcArea3DPoly_c(__pyx_v_n, __pyx_v_ps, __pyx_v_N));
</pre><pre class="cython line score-0">&#xA0;<span class="">210</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:     <span class="n">free</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_ps);
</pre><pre class="cython line score-0">&#xA0;<span class="">212</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>:     <span class="k">return</span> <span class="n">area</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_area);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 213, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_r = __pyx_t_11;
  __pyx_t_11 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">214</span>: </pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>: <span class="k">def</span> <span class="nf">calcAngle</span><span class="p">(</span></pre>
<pre class='cython code score-52 '>/* Python wrapper */
static PyObject *__pyx_pw_8owcsimpy_8geoutils_6cutils_5calcAngle(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8owcsimpy_8geoutils_6cutils_4calcAngle[] = "calcAngle(ndarray v1, ndarray v2)";
static PyMethodDef __pyx_mdef_8owcsimpy_8geoutils_6cutils_5calcAngle = {"calcAngle", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8owcsimpy_8geoutils_6cutils_5calcAngle, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8owcsimpy_8geoutils_6cutils_4calcAngle};
static PyObject *__pyx_pw_8owcsimpy_8geoutils_6cutils_5calcAngle(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_v1 = 0;
  PyArrayObject *__pyx_v_v2 = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calcAngle (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v1,&amp;__pyx_n_s_v2,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_v1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_v2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcAngle", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcAngle") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_v1 = ((PyArrayObject *)values[0]);
    __pyx_v_v2 = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcAngle", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("owcsimpy.geoutils.cutils.calcAngle", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v1), __pyx_ptype_5numpy_ndarray, 1, "v1", 0))) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v2), __pyx_ptype_5numpy_ndarray, 1, "v2", 0))) <span class='error_goto'>__PYX_ERR(0, 217, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8owcsimpy_8geoutils_6cutils_4calcAngle(__pyx_self, __pyx_v_v1, __pyx_v_v2);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8owcsimpy_8geoutils_6cutils_4calcAngle(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v1, PyArrayObject *__pyx_v_v2) {
  Point __pyx_v_v1_c;
  Point __pyx_v_v2_c;
  double __pyx_v_angle;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calcAngle", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_v1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_v2);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("owcsimpy.geoutils.cutils.calcAngle", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_v1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_v2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_v1, __pyx_n_s_v2, __pyx_n_s_v1_c, __pyx_n_s_v2_c, __pyx_n_s_angle);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_8owcsimpy_8geoutils_6cutils_5calcAngle, 0, __pyx_n_s_calcAngle, NULL, __pyx_n_s_owcsimpy_geoutils_cutils, __pyx_d, ((PyObject *)__pyx_codeobj__16));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calcAngle, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__16 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__15, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_owcsimpy_geoutils_cutils_pyx, __pyx_n_s_calcAngle, 215, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">216</span>:     <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">v1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">217</span>:     <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">v2</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">218</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>:     <span class="c"># Casting to float</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>:     <span class="n">v1</span> <span class="o">=</span> <span class="n">v1</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_v1), __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 220, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, ((PyObject *)(&amp;PyFloat_Type))) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)(&amp;PyFloat_Type)));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_v1, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:     <span class="n">v2</span> <span class="o">=</span> <span class="n">v2</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_v2), __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 221, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, ((PyObject *)(&amp;PyFloat_Type))) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)(&amp;PyFloat_Type)));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_v2, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">222</span>: </pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:     <span class="k">cdef</span> <span class="kt">Point</span> <span class="nf">v1_c</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span><span class="n">v1</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="s">&#39;y&#39;</span><span class="p">:</span><span class="n">v1</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="s">&#39;z&#39;</span><span class="p">:</span><span class="n">v1</span><span class="p">[</span><span class="mf">2</span><span class="p">]}</span></pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_v1), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4.x = __pyx_t_5;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_v1), 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4.y = __pyx_t_5;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_v1), 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4.z = __pyx_t_5;
  __pyx_v_v1_c = __pyx_t_4;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:     <span class="k">cdef</span> <span class="kt">Point</span> <span class="nf">v2_c</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span><span class="n">v2</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="s">&#39;y&#39;</span><span class="p">:</span><span class="n">v2</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="s">&#39;z&#39;</span><span class="p">:</span><span class="n">v2</span><span class="p">[</span><span class="mf">2</span><span class="p">]}</span></pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_v2), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4.x = __pyx_t_5;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_v2), 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4.y = __pyx_t_5;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_v2), 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4.z = __pyx_t_5;
  __pyx_v_v2_c = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">225</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">angle</span> <span class="o">=</span> <span class="n">calcAngle_c</span><span class="p">(</span><span class="n">v1_c</span><span class="p">,</span><span class="n">v2_c</span><span class="p">);</span></pre>
<pre class='cython code score-0 '>  __pyx_v_angle = calcAngle_c(__pyx_v_v1_c, __pyx_v_v2_c);
</pre><pre class="cython line score-0">&#xA0;<span class="">227</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:     <span class="k">return</span> <span class="n">angle</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_angle);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">229</span>: </pre>
<pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>: <span class="k">def</span> <span class="nf">calcRodriguesMtx</span><span class="p">(</span><span class="n">double</span> <span class="n">angle</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">k_in</span><span class="p">):</span></pre>
<pre class='cython code score-56 '>/* Python wrapper */
static PyObject *__pyx_pw_8owcsimpy_8geoutils_6cutils_7calcRodriguesMtx(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8owcsimpy_8geoutils_6cutils_6calcRodriguesMtx[] = "calcRodriguesMtx(double angle, ndarray k_in)";
static PyMethodDef __pyx_mdef_8owcsimpy_8geoutils_6cutils_7calcRodriguesMtx = {"calcRodriguesMtx", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8owcsimpy_8geoutils_6cutils_7calcRodriguesMtx, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8owcsimpy_8geoutils_6cutils_6calcRodriguesMtx};
static PyObject *__pyx_pw_8owcsimpy_8geoutils_6cutils_7calcRodriguesMtx(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_angle;
  PyArrayObject *__pyx_v_k_in = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calcRodriguesMtx (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_angle,&amp;__pyx_n_s_k_in,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_k_in)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcRodriguesMtx", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcRodriguesMtx") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_angle = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_angle == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L3_error)</span>
    __pyx_v_k_in = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calcRodriguesMtx", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("owcsimpy.geoutils.cutils.calcRodriguesMtx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_k_in), __pyx_ptype_5numpy_ndarray, 1, "k_in", 0))) <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8owcsimpy_8geoutils_6cutils_6calcRodriguesMtx(__pyx_self, __pyx_v_angle, __pyx_v_k_in);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8owcsimpy_8geoutils_6cutils_6calcRodriguesMtx(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_angle, PyArrayObject *__pyx_v_k_in) {
  double *__pyx_v_R_pt;
  double __pyx_v_k[3];
  double *__pyx_v_k_pt;
  PyObject *__pyx_v_R = NULL;
  long __pyx_7genexpr__pyx_v_idx;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calcRodriguesMtx", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("owcsimpy.geoutils.cutils.calcRodriguesMtx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_R);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_angle, __pyx_n_s_k_in, __pyx_n_s_R_pt, __pyx_n_s_k, __pyx_n_s_k_pt, __pyx_n_s_R, __pyx_n_s_idx);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_8owcsimpy_8geoutils_6cutils_7calcRodriguesMtx, 0, __pyx_n_s_calcRodriguesMtx, NULL, __pyx_n_s_owcsimpy_geoutils_cutils, __pyx_d, ((PyObject *)__pyx_codeobj__18));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calcRodriguesMtx, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">231</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:     <span class="k">cdef</span> <span class="kt">double</span> *<span class="nf">R_pt</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">double</span> <span class="o">*&gt;</span> <span class="n">malloc</span><span class="p">(</span><span class="mf">9</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">double</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_R_pt = ((double *)malloc((9 * (sizeof(double)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">233</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">234</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="kt">k</span>[3]</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:     <span class="n">k</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">k_in</span></pre>
<pre class='cython code score-0 '>  if (unlikely(__Pyx_carray_from_py_double(((PyObject *)__pyx_v_k_in), __pyx_t_1, 3) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 235, __pyx_L1_error)</span>
  memcpy(&amp;(__pyx_v_k[0]), __pyx_t_1, sizeof(__pyx_v_k[0]) * (3));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:     <span class="k">cdef</span> <span class="kt">double</span> *<span class="nf">k_pt</span> <span class="o">=</span> <span class="n">k</span></pre>
<pre class='cython code score-0 '>  __pyx_v_k_pt = __pyx_v_k;
</pre><pre class="cython line score-0">&#xA0;<span class="">237</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:     <span class="n">calcRodriguesMtx_c</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">k_pt</span><span class="p">,</span> <span class="n">R_pt</span><span class="p">);</span></pre>
<pre class='cython code score-0 '>  calcRodriguesMtx_c(__pyx_v_angle, __pyx_v_k_pt, __pyx_v_R_pt);
</pre><pre class="cython line score-0">&#xA0;<span class="">239</span>: </pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:     <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">R_pt</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">9</span><span class="p">)]])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-50 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  { /* enter inner scope */
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; 9; __pyx_t_5+=1) {
      __pyx_7genexpr__pyx_v_idx = __pyx_t_5;
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_R_pt[__pyx_7genexpr__pyx_v_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_6))) <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
  } /* exit inner scope */
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_R = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_3, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:     <span class="n">free</span><span class="p">(</span><span class="n">R_pt</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_R_pt);
</pre><pre class="cython line score-0">&#xA0;<span class="">242</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:     <span class="k">return</span> <span class="n">R</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_R);
  __pyx_r = __pyx_v_R;
  goto __pyx_L0;
</pre></div></body></html>
